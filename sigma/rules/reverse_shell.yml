title: Reverse Shell Detection
id: sib-revshell-001
status: experimental
description: Detects common reverse shell patterns
author: SIB
date: 2024-01-01
references:
    - https://attack.mitre.org/techniques/T1059/
logsource:
    category: process_creation
    product: linux
detection:
    selection_bash:
        CommandLine|contains:
            - 'bash -i >&'
            - 'bash -c "bash -i'
            - '/dev/tcp/'
            - '/dev/udp/'
    selection_nc:
        CommandLine|contains:
            - 'nc -e /bin'
            - 'nc -c /bin'
            - 'ncat -e'
    selection_python:
        CommandLine|contains:
            - 'python -c "import socket'
            - 'python3 -c "import socket'
            - 'pty.spawn'
    selection_perl:
        CommandLine|contains:
            - 'perl -e "use Socket'
            - 'perl -MIO -e'
    condition: selection_bash or selection_nc or selection_python or selection_perl
falsepositives:
    - Legitimate remote administration
    - Penetration testing
level: critical
tags:
    - attack.execution
    - attack.t1059
    - attack.command_and_control
